package edu.neumont.csc252;

public class DotsAndBoxes {

	private Graph g;
	private int[] players;
	private int columnNum;
	private int numberOfVerticies;

	public DotsAndBoxes(int rows, int columns){

		this.columnNum = columns + 1;
		players = new int[2];
		this.numberOfVerticies = (rows + 1) * (columns + 1);

		g = new Graph( numberOfVerticies );

		for (int j = 0; j < g.vcount(); j++){

			if (j - (columnNum) > 0 
					&& j + (columnNum) < numberOfVerticies - 1
					&& (j + 1)  % (columnNum) != 0 
					&& j % (columnNum) != 0){

				g.addEdge(j, j - (columnNum) , 1);
				g.addEdge(j, j + (columnNum), 1);
				g.addEdge(j, (j - 1) , 1);
				g.addEdge(j, (j + 1), 1);
			}

		} 

	}

	public int drawLine(int player, int x1, int y1, int x2, int y2){

		int points = 0;

		int v = x2 + (y2 * columnNum);
		int w = -1;

		if (x1 == x2){
			w = v + 1;
		}
		else if (y1 == y2){
			w = v + columnNum;
		}

		if ( w != -1){

			g.removeEdge(v, w);
			System.out.println(v + " " + w);
			int vDeg = g.degree(v);
			int wDeg = g.degree(w);

			if (vDeg == 0 && !(this.onOutside(v)) ){
				points++;
			}
			if (wDeg == 0 && !(this.onOutside(w)) ){
				points++;
			}
			players[player - 1] = players[player - 1] + points;

			return points;
		}

		return -1;
	}

	public int score(int player){
		// returns the score for a player
		return players[player - 1];
	}

	public boolean areMovesLeft(){ 
		// returns whether or not there are any lines to be drawn

		return false;
	}

	public int countDoubleCrosses(){
		// returns the number of double-crosses on the board
		return -1;
	}

	public int countCycles(){
		// returns the number of cycles on the board
		return -1;
	}

	public int countOpenChains(){
		// returns the number of open chains on the board
		return -1;
	}

	private boolean onOutside(int v){

		if (v < this.columnNum){
			return true;
		}
		else if (v % this.columnNum == 0 ||
				v % (v - this.columnNum) == columnNum ||
				v > (this.numberOfVerticies - 1) - this.columnNum
				){
			return true;
		}

		return false;
	}

}
