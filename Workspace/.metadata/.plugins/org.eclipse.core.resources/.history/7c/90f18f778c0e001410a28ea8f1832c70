package edu.neumont.csc250;

import java.util.ArrayList;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

import edu.neumont.nlp.DecodingDictionary;

public class ExhaustiveDecoder  {

	private DecodingDictionary dd = new DecodingDictionary();

	public List<String> decode(String message) {

		ArrayList<String> possibilities = new ArrayList<String>();
		Set<String> soFar = new HashSet<String>();

		decodeHelper(soFar, message, possibilities);

		return possibilities;
	}

	private void decodeHelper(Set<String> soFar, String toGo, List<String> possibilities){

		if (toGo.isEmpty() ){
			possibilities.addAll(soFar);
			return;
		}

		for (int index = 0; index < toGo.length(); index++){

			for (int i = index + 1; i < toGo.length() - index; i ++){

				Set<String> words = dd.getWordsForCode(toGo.substring(index, index + i));

				for (String s : soFar){
					if (words != null){
						for (String w: words){
							int frequency = dd.frequencyOfFollowingWord(s, w);
							System.out.println(s + " " + w + " " + frequency +  " " + toGo);
							if (frequency < 50000)
								return;
						}
					}
				}

				if (words != null){
					for (String s : words){

						Set<String> newSoFar = soFar;
						soFar.add(s);

						String newToGo = toGo;
						newToGo = newToGo.substring(index + i);

						decodeHelper(newSoFar, newToGo, possibilities);
					}
				}
			}
		}
	}
}
